#!/usr/bin/env bash
set -e

setup_test_env() {
    echo "Setting up test environmentâ€¦"
    python3.6 -m venv venv
    . venv/bin/activate
    pip install pip-tools
    pip-sync requirements.txt dev-requirements.txt
}

run_unit_tests() {
    PYTHONPATH=. pytest
}

setup_test_env
run_unit_tests

package_wheel create_rootfs
wheel_path=${__package_wheel}
publish ${wheel_path}
